* Productivity

** pomidor

#+BEGIN_SRC emacs-lisp

  (use-package pomidor
    :bind (("<f12>" . pomidor))
    :config (setq pomidor-sound-tick nil
                  pomidor-sound-tack nil)
    :hook (pomidor-mode . (lambda ()
                            (display-line-numbers-mode -1) ; Emacs 26.1+
                            (setq left-fringe-width 0 right-fringe-width 0)
                            (setq left-margin-width 2 right-margin-width 0)
                            ;; force fringe update
                            (set-window-buffer nil (current-buffer)))))

#+END_SRC

* Note Taking

** Org

#+begin_src emacs-lisp

  (use-package org
    :config
    ;; (setq org-table-header-line-p t)
    (setq org-startup-with-inline-images t) ;; render images
    (setq org-hide-emphasis-markers t)
    (setq org-ellipsis " ▾")
    ;; (setq org-hide-block-startup t)
    (setq org-list-demote-modify-bullet
          '(("-" . "+") ("+" . "-") ("*" . "+")))
    (setq-default org-list-indent-offset 1)
    (setq org-yank-adjusted-subtrees t) ;; lets me use C-y as the C-c C-x C-y
    (setq org-list-allow-alphabetical t)
    ;; (setq org-yank-folded-subtrees nil) ;; don't fold when pasting org sub-trees
    ;; Set faces for heading levels

    ;; replace list hypehen(-) with dot
    (font-lock-add-keywords
     'org-mode
     '(("^ *\\([-]\\) "
        (0 (prog1 () (compose-region 
                      (match-beginning 1)
                      (match-end 1) "•"))))))

    ;; enable auto line breaking in org-mode
    ;; (add-hook 'org-mode-hook (lambda() ((turn-on-auto-fill))))

    ;; add org source block templates
    (require 'org-tempo)
    (add-to-list 'org-structure-template-alist '("sh" . "src shell"))
    (add-to-list 'org-structure-template-alist '("el" . "src emacs-lisp"))
    (add-to-list 'org-structure-template-alist '("js" . "src javascript"))
    (add-to-list 'org-structure-template-alist '("lua" . "src lua"))
    (add-to-list 'org-structure-template-alist '("py" . "src python"))
    (add-to-list 'org-structure-template-alist '("html" . "src html"))
    (add-to-list 'org-structure-template-alist '("css" . "src css"))
    (add-to-list 'org-structure-template-alist '("lisp" . "src lisp")))

#+end_src

*** buffer-face-mode

Enable ~buffer-face-mode~ in org files in order to customize buffer specific font config.

#+begin_src emacs-lisp

  (add-hook 'org-mode-hook (lambda () (buffer-face-mode)))

#+end_src

*** Activate *org-indent-mode*

#+begin_src emacs-lisp

  (add-hook 'org-mode-hook (lambda () (org-indent-mode 1)))

#+end_src

*** Add Org keybindings.

#+begin_src emacs-lisp

  (global-set-key (kbd "C-c l") #'org-store-link)
  (global-set-key (kbd "C-c a") #'org-agenda)
  ;; (global-set-key (kbd "C-c c") #'org-capture)

#+end_src

*** Tasks Keywords

#+begin_src emacs-lisp

  (setq org-todo-keywords
      '((sequence
          "TODO(t)"         ; A task that is ready to be tackled
          "WAIT(w)"         ; Something is holding up this task
          "DOING(d)"        ; When i am doing a task
          "|"               ; The pipe to separate "active" and "inactive" states
          "DONE(D)"         ; Task has been completed
          "CANCELLED(c)" ))); Task has been cancelled

#+end_src

*** TODO ??

#+begin_src emacs-lisp

  ;; (defvar-local my-icon-dir (concat user-emacs-directory "icons/")
  ;; "directory withthe icons")
  ;;   (setq org-agenda-category-icon-alist '(
  ;;   ("todo" ,(concat my-icon-dir "check-box.png") nil nil :ascent center)
  ;; ))

#+end_src

** Org Roam

#+begin_src emacs-lisp

  (use-package org-roam
    :init
    ;; (setq find-file-visit-truename t) ;; resolve the symalink problems
    (setq org-roam-directory (file-truename "~/safdar-local/org-roam-notes"))

    (setq org-roam-node-display-template
          (concat "${title:*} "
                  (propertize "${tags:10}" 'face 'org-tag)))
    (setq org-roam-completion-everywhere t)	
    (setq org-roam-mode-sections
          (list #'org-roam-backlinks-section
                #'org-roam-reflinks-section
                #'org-roam-unlinked-references-section
                ))
    :custom
    ;; templates
    (org-roam-capture-templates
     '(("d" "default" plain
        "%?"
        :if-new (file+head "${title}.org" "#+title: ${title}\n")
        :unnarrowed t)))
    :config
    (org-roam-setup)
    (org-roam-db-autosync-mode)

    (defhydra hydra-org-roam ()
      "
          ^Node Actions^   ^Buffer^               ^Journal^         ^Capture
          ^^^^^^^^-------------------------------------------------------------------------
          _f_: Find node   _b t_: Buffer toggle    _j t_: Today     _c c_: Choose Node
          _i_: Insert Node _b d_: Dedicated buffer _j T_: Tomorrow  _c t_: Today Journal
          ^ ^              _b r_: Refresh Buffer   _j y_: Yesterday _c T_: Tomorrow Journal
          "
      ;; node
      ("f" org-roam-node-find nil)
      ("i" org-roam-node-insert nil)

      ;; buffer
      ("b t" org-roam-buffer-toggle nil)
      ("b d" org-roam-buffer-display-dedicated nil)
      ("b r" org-roam-buffer-refresh nil)

      ;; capture
      ("c c" org-roam-capture nil)
      ("c t" org-roam-dailies-capture-today nil)
      ("c T" org-roam-dailies-capture-tomorrow nil)

      ;; journal
      ("j t" org-roam-dailies-goto-today nil)
      ("j T" org-roam-dailies-goto-tomorrow nil)
      ("j y" org-roam-dailies-goto-yesterday nil))
    (global-set-key (kbd "C-c o") 'hydra-org-roam/body))

#+end_src

*** Org-roam-ui

#+begin_src emacs-lisp

  (use-package org-roam-ui)

#+end_src

** Org-bullets
#+begin_src emacs-lisp

  (use-package org-bullets
    :init
    (add-hook 'org-mode-hook (lambda () (org-bullets-mode 1)))
    :custom
    (org-bullets-bullet-list 
     '("◉" "○" "●" "○" "●" "○" "●")))

#+end_src

** Anki Integration

Write Anki cards  in org-mode

#+begin_src emacs-lisp

  (use-package anki-editor)

#+end_src

* Org Reading Mode

My minor mode for reading org mode documents.

- [ ] when you understand enough ~emacs-lisp~ write this function to enable margins in ~org-mode~ only, without having to enable it everywhere.

- [X] also hide the ~mode-line~

#+begin_src emacs-lisp

  (defun reading-mode ()
    (set-window-margins nil 8 8)
    (global-display-line-numbers-mode 0)
    (mode-line 0)
    ;; (hidden-mode-line-mode)
    )

  (defun no-reading-mode ()
    (set-window-margins nil 0 0)
    (global-display-line-numbers-mode 1)
    ;; (hidden-mode-line-mode)
    )

  (defhydra hydra-reading-mode ()
    "
             ^Reading Mode Commands^
    ^^^^^^^^-----------------------------------------
    _e_: Enable Reading Mode _d_: Disable Reading Mode   
    "
    ("e" (reading-mode) nil)
    ("d" (no-reading-mode) nil))
  (global-set-key (kbd "C-c p") 'hydra-reading-mode/body)

#+end_src
